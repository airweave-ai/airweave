import{aY as O,aZ as E,a_ as y,a$ as F,b0 as v,n as T,r as d,b1 as S,b2 as A,j as e,a as m}from"./main-BEToz-TC.js";import{T as M,a as P,b as g,c as C}from"./tabs-DYoc-HWa.js";var K=class extends O{#s;#n=void 0;#e;#t;constructor(s,t){super(),this.#s=s,this.setOptions(t),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){const t=this.options;this.options=this.#s.defaultMutationOptions(s),E(this.options,t)||this.#s.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),t?.mutationKey&&this.options.mutationKey&&y(t.mutationKey)!==y(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(s){this.#r(),this.#i(s)}getCurrentResult(){return this.#n}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#r(),this.#i()}mutate(s,t){return this.#t=t,this.#e?.removeObserver(this),this.#e=this.#s.getMutationCache().build(this.#s,this.options),this.#e.addObserver(this),this.#e.execute(s)}#r(){const s=this.#e?.state??F();this.#n={...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset}}#i(s){v.batch(()=>{if(this.#t&&this.hasListeners()){const t=this.#n.variables,c=this.#n.context,n={client:this.#s,meta:this.options.meta,mutationKey:this.options.mutationKey};if(s?.type==="success"){try{this.#t.onSuccess?.(s.data,t,c,n)}catch(r){Promise.reject(r)}try{this.#t.onSettled?.(s.data,null,t,c,n)}catch(r){Promise.reject(r)}}else if(s?.type==="error"){try{this.#t.onError?.(s.error,t,c,n)}catch(r){Promise.reject(r)}try{this.#t.onSettled?.(void 0,s.error,t,c,n)}catch(r){Promise.reject(r)}}}this.listeners.forEach(t=>{t(this.#n)})})}};function D(s,t){const c=T(),[n]=d.useState(()=>new K(c,s));d.useEffect(()=>{n.setOptions(s)},[n,s]);const r=d.useSyncExternalStore(d.useCallback(i=>n.subscribe(v.batchCalls(i)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),l=d.useCallback((i,a)=>{n.mutate(i,a).catch(S)},[n]);if(r.error&&A(n.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:l,mutateAsync:r.mutate}}const z=d.createContext(null);function R(){const s=d.useContext(z);if(!s)throw new Error("ApiForm compound components must be used within ApiForm");return s}const k={GET:"text-blue-400",POST:"text-emerald-400",PUT:"text-orange-400",DELETE:"text-red-400",PATCH:"text-yellow-400"};function f({method:s,endpoint:t,body:c,onBodyChange:n,defaultTab:r="form",children:l,className:i}){const[a,o]=d.useState(r);return e.jsx(z.Provider,{value:{method:s,endpoint:t,body:c,onBodyChange:n,activeTab:a,setActiveTab:o},children:e.jsx(M,{value:a,onValueChange:h=>o(h),className:m("w-full",i),children:l})})}function B({className:s}){return e.jsxs(P,{className:m("w-full",s),children:[e.jsx(g,{value:"form",className:"flex-1",children:"Form"}),e.jsx(g,{value:"code",className:"flex-1",children:"Code"})]})}function L({children:s,className:t}){return e.jsx(C,{value:"form",className:m("py-4",t),children:s})}function N({keyName:s,value:t,path:c,editable:n,onValueChange:r,indent:l}){const i=`pl-${l*4}`;if(t===null)return e.jsxs("div",{className:i,children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": "}),e.jsx("span",{className:"text-zinc-500",children:"null"})]});if(typeof t=="boolean")return e.jsxs("div",{className:m("flex items-center",i),children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": "}),n?e.jsx("button",{type:"button",onClick:()=>r(c,!t),className:"text-amber-400 underline underline-offset-2 hover:text-amber-300",children:t.toString()}):e.jsx("span",{className:"text-amber-400",children:t.toString()})]});if(typeof t=="number")return e.jsxs("div",{className:m("flex items-center",i),children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": "}),n?e.jsx("input",{type:"number",value:t,onChange:a=>{const o=parseFloat(a.target.value);isNaN(o)||r(c,o)},className:"w-20 rounded border border-zinc-700 bg-zinc-800 px-1.5 py-0.5 font-mono text-xs text-amber-400 focus:border-emerald-500 focus:outline-none"}):e.jsx("span",{className:"text-amber-400",children:t})]});if(typeof t=="string")return e.jsxs("div",{className:m("flex items-center",i),children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": "}),n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-emerald-400",children:'"'}),e.jsx("input",{type:"text",value:t,onChange:a=>r(c,a.target.value),className:"min-w-[60px] rounded border border-zinc-700 bg-zinc-800 px-1.5 py-0.5 font-mono text-xs text-emerald-400 focus:border-emerald-500 focus:outline-none",style:{width:`${Math.max(60,t.length*8)}px`}}),e.jsx("span",{className:"text-emerald-400",children:'"'})]}):e.jsxs("span",{className:"text-emerald-400",children:['"',t,'"']})]});if(Array.isArray(t))return t.length===0?e.jsxs("div",{className:i,children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": []"})]}):e.jsxs("div",{className:i,children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": ["}),t.map((a,o)=>e.jsx(N,{keyName:String(o),value:a,path:[...c,String(o)],editable:n,onValueChange:r,indent:l+1},o)),e.jsx("div",{className:i,children:e.jsx("span",{className:"text-zinc-100",children:"]"})})]});if(typeof t=="object"){const a=Object.entries(t);return a.length===0?e.jsxs("div",{className:i,children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": {}"})]}):e.jsxs("div",{className:i,children:[e.jsxs("span",{className:"text-sky-400",children:['"',s,'"']}),e.jsx("span",{className:"text-zinc-100",children:": {"}),a.map(([o,h],p)=>e.jsxs(d.Fragment,{children:[e.jsx(N,{keyName:o,value:h,path:[...c,o],editable:n,onValueChange:r,indent:l+1}),p<a.length-1&&e.jsx("span",{className:"text-zinc-500",children:","})]},o)),e.jsx("div",{className:i,children:e.jsx("span",{className:"text-zinc-100",children:"}"})})]})}return null}function U({editable:s=!1,className:t}){const{method:c,endpoint:n,body:r,onBodyChange:l}=R(),i=(h,p)=>{if(!l)return;const j={...r};let x=j;for(let b=0;b<h.length-1;b++){const u=h[b];typeof x[u]=="object"&&x[u]!==null&&(x[u]=Array.isArray(x[u])?[...x[u]]:{...x[u]},x=x[u])}const w=h[h.length-1];x[w]=p,l(j)},a=Object.entries(r),o=a.length>0;return e.jsxs(C,{value:"code",className:m("py-4",t),children:[e.jsxs("div",{className:"rounded-lg bg-zinc-950 p-4 font-mono text-sm",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[e.jsx("span",{className:m("font-semibold",k[c]),children:c}),e.jsx("span",{className:"text-zinc-400",children:n})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2 text-xs text-zinc-400",children:"Request Body"}),e.jsxs("div",{className:"text-xs leading-relaxed text-zinc-100",children:[e.jsx("div",{children:"{"}),a.map(([h,p],j)=>e.jsxs(d.Fragment,{children:[e.jsx(N,{keyName:h,value:p,path:[h],editable:s&&!!l,onValueChange:i,indent:1}),j<a.length-1&&e.jsx("span",{className:"pl-4 text-zinc-500",children:","})]},h)),e.jsx("div",{children:"}"})]})]})]}),s&&l&&e.jsx("p",{className:"text-muted-foreground mt-3 text-xs",children:"Edit values above or use the Form tab for a guided experience."})]})}function V({children:s,className:t}){return e.jsx("div",{className:m("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),children:s})}f.Toggle=B;f.FormView=L;f.CodeView=U;f.Footer=V;export{f as A,D as u};
